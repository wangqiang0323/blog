<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>uni-app</title>
      <link href="/blog/2021/032854796.html"/>
      <url>/blog/2021/032854796.html</url>
      
        <content type="html"><![CDATA[<h3 id="uni-app"><a href="#uni-app" class="headerlink" title="uni-app"></a>uni-app</h3><ol><li>首先装HBuilderX，xcode，微信开发者等工具</li></ol>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APP </tag>
            
            <tag> 跨平台 </tag>
            
            <tag> 小程序 </tag>
            
            <tag> h5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>闭包</title>
      <link href="/blog/2021/03287415.html"/>
      <url>/blog/2021/03287415.html</url>
      
        <content type="html"><![CDATA[<h1 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h1><h3 id="变量作用域"><a href="#变量作用域" class="headerlink" title="变量作用域"></a>变量作用域</h3><p>变量作用域两种：全局变量、局部变量。</p><ul><li>全局变量：函数外声明的变量，称为全局变量</li><li> 局部变量：函数内部使用var声明的变量，称为局部变量</li></ul><p>在JS中（ES5），只有函数作用域，没有块级作用域！！！也就是说，if/for等有{}的结构体，并不能具备自己的作用域。（ES6提供了块级作用域，let、const）</p><p>所以，函数外部不能访问函数内部局部变量（私有属性）。因为，函数内部的变量，在函数执行完毕以后，就会被释放掉。（涉及js垃圾回收机制）</p><h3 id="如何从外部读取函数内部的变量？"><a href="#如何从外部读取函数内部的变量？" class="headerlink" title="如何从外部读取函数内部的变量？"></a>如何从外部读取函数内部的变量？</h3><pre class="line-numbers language-none"><code class="language-none">function func1()&#123;var a &#x3D; 12function func2()&#123;    &#x2F;&#x2F; func2是一个闭包alert(a)&#125;return func2&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>js链式作用域：子对象会一级一级向上寻找所有父对象的变量，反之不行。</li><li>func2可以读取func1内的变量，只要将func2作为返回值，就可以在func1外部读取func1内部变量</li></ul><h3 id="闭包的概念"><a href="#闭包的概念" class="headerlink" title="闭包的概念"></a>闭包的概念</h3><p>  能够读取其他函数内部变量的函数；<br>  或简单理解为定义在一个函数内部的函数，内部函数持有外部函数内变量的引用。</p><h3 id="闭包的用途"><a href="#闭包的用途" class="headerlink" title="闭包的用途"></a>闭包的用途</h3><ul><li><p>读取函数内部的变量</p></li><li><p>让这些变量的值始终保持在内存中。不会在func1调用后被自动清除。<br>func1是func2的父函数，func2被赋给了一个全局变量。因此，func2始终存在内存中，func2的存在依赖func1，因此func1也始终存在内存中，不会在调用结束后，被垃圾回收机制回收。</p><blockquote><p>垃圾回收机制：（js内存管理的主要概念-可达性）<br>1、可达性即那些以某种方式可访问或可用的值，它们被保证存储在内存中。<br>2、一般来说没有被引用的对象就是垃圾，就是要被清除。 有个例外如果几个对象引用形成一个环，互相引用，但“根”访问不到它们，这几个对象也是垃圾，也要被清除。即可达性，</p></blockquote></li><li><p>方便调用上下文的局部变量。利于代码封装。</p></li></ul><h3 id="闭包的理解"><a href="#闭包的理解" class="headerlink" title="闭包的理解"></a>闭包的理解</h3><pre class="line-numbers language-none"><code class="language-none">function init() &#123;var name &#x3D; &quot;Chrome&quot;;    &#x2F;&#x2F;创建局部变量name和局部函数alertNamefunction alertName() &#123; &#x2F;&#x2F;alertName()是函数内部方法，是一个闭包alert(name); &#x2F;&#x2F;使用了外部函数声明的变量，内部函数可以访问外部函数的变量&#125;alertName();&#125;init();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>词法作用域中使用的域，是变量在代码中声明的位置所决定的（全局，函数，块级）。嵌套的函数可以访问在其外部声明的变量。</li></ul><pre class="line-numbers language-none"><code class="language-none">function outFun()&#123;var name &#x3D; &quot;Chrome&quot;;function alertName()&#123;alert(name);&#125;return alertName;   &#x2F;&#x2F;alertName被外部函数作为返回值返回了,返回的是一个闭包&#125;var myFun &#x3D; outFun();myFun();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>闭包有函数+它的词法环境；词法环境指函数创建时可访问的所有变量。</li><li>myFun引用了一个闭包，闭包由alertName()和闭包创建时存在的“Chrome”字符串组成。alertName()持有了name的引用，myFun持有了alertName()的访问，因此myFun调用时，name还是处于可以访问的状态。</li></ul><pre class="line-numbers language-none"><code class="language-none">function makeAdder(x)&#123;return function(y)&#123;return x + y;&#125;;&#125;var add5&#x3D; makeAdder(5);var add10&#x3D; makeAdder(10);console.log(add5(2)); &#x2F;&#x2F; 7console.log(add10(2));  &#x2F;&#x2F; 12<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>在这个示例中，我们定义了 makeAdder(x) 函数，它接受一个参数 x ，并返回一个新的函数。返回的函数接受一个参数 y，并返回x+y的值。</li><li>从本质上讲，makeAdder 是一个函数工厂 — 他创建了将指定的值和它的参数相加求和的函数。在上面的示例中，我们使用函数工厂创建了两个新函数 — 一个将其参数和 5 求和，另一个和 10 求和。</li><li>add5和add10都是闭包。它们共享相同的函数定义，但是保存了不同的词法环境。在 add5 的环境中，x 为 5。而在 add10 中，x 则为 10。</li></ul><h3 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h3><p><a href="%5Bhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures%5D(https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures)">MDN</a><br><a href="https://segmentfault.com/a/1190000018605776">前端面试：谈谈 JS 垃圾回收机制</a><br><a href="https://segmentfault.com/a/1190000010640225">ES6 变量作用域与提升：变量的生命周期详解</a><br><a href="https://www.jianshu.com/p/2fb8a9f26589">关于JavaScript中的闭包及应用场景</a></p>]]></content>
      
      
      <categories>
          
          <category> Javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记</title>
      <link href="/blog/2021/032863421.html"/>
      <url>/blog/2021/032863421.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="ec32ab4a58ea36022f81fd818277954635a97747f48894dde884cc60adb272fb">7a74c43aa496371c4d21577c7c123d6c025f9058deb80ee8f8615e5b893d459128dacb65dd09694fdc0d9afa49ba005127e56621b33b250aa21e4c846bd038dab6add47da8abc66216ba4d184ca25ee152b1d7e5a6f153428203bee3c826ec071999d208de5464d93cbf0d3165084382d00fa3b94c117db9c8e2824410e8cfe1d6e680718b2e2b5e11e06dc12abc622ca1968c5ad1c09d63d91da36d2406f4a66c6f91c63d3b328e64fdcbbc7d36709554d57de65599c3dabc9c5197909992c59e75356a257930999962618ddc4561c76047fd3c3a8f9072ab16485fb3caa296025ac76cf43c5fc4183fcb399b5b8d7a7ce39a767d6bb8660a6b145bc3bf2cadac56834f23bedaee99ef2404e4db089811c816d083e3534ee04fbe27633be07d3f9c663e164c7b4d71ef1e20c474f2d5bb4ed86d3b7ddb0e11896fd9b04e5ff81a3546e5beb8ffd29865d1ed0637620d0580a25f359f6c42e514ed3764a3e1add79f13a37804fe20f5f13462f9c9179afadf6e7ad5eb969a075569e131ee89fc5ca308cb3bac7ecf28eea461ca7b9b306abd8a860d5b2a60c1a09fae43aaee816a7db6de8feb8484b1228403aa8452706488d971d645ea943617d622f0ec7354bbbd07584986854a2716b6d1546a9476ed37c13971d052f1200767d42bb61805d7935bb9e8e0aef0c622aae297c1ec24f16636699b02e28998788f75485ea73d90dfe51886348a060187eda792e2e7539e2324ca5203b67c84039fdca0d1b8c1006b87efa8a9fa0fc25fdb88d5b8c4d6d4e42f6041d45d86df066f1cbc06d851d5c6fd3cf1ec97a5e0a91d5d9a45c9ad929ac465296a5b0362a4f962c40c67d9d0cd068557442fe8d5d431eac26394421887599965dae17bf0456ac48629e5301865d0589ba8b2b557acf3b688ef1192e54df6f88c9802dbfa84364a0a455b28fc4d3cb9115719af69dca1676731581edfb5ccbec6c1305e526c603cc5c3e7d4f628bfa55d8f296911a1fab67bd1a05a5ba465b0a30262a9853ed42d5933ae67c416618ad516398c52ffb688ab9d8a8fa52776932d441770ef281e60dc2c8828cebe5151bb49958817364d46500abae1ef0fc7546ddcbfae49c9e0167505c0926b28309db888bc3d38defd07c79b0c188a7adf472ceb9588034d65bfe740c3ddadf7934dbaa440450bf945d13a01bbf6a4abb12c8a9536750b1b2e5d4c18c0079f599f2e377ff7d63e045d07b6a7b6281ffccfc8a2679e98d965bf6485afc914c60ff3b41e64526b93b5f721377a48f76aeab554b809363164c86f58c5953fea49e26c9632d6fbb929f0642bab07a8ae472c4104fb8b33d832bfb77d2121e728556818deaba382ab8fd0fdb014d2f38a5996157755f98dccce1684816ae98de5bfb83f8396dcc14c2aa8fc7353223a4cbdaed351c088cd100fb75e5eea20c02b1fc6e0cf264d6b02308f7893bcdfc6b139579af822ce6796035604bccab2a6f198424893bd8e9e904597f410719b889cd9ef389fa21d5061905c09abeae4b367407a4d283256029a1069aa1582f8b7dfb100282072f7d5d86232ea886f6901f7906e222ea0820ed8d657a9489f5b40ba4b32cfa8a315398f5ac8f80d414f105a9795aa5561de4e76229cc957975404bab6e0a1b5aaccff6f2b460c88f1d7fc883fcf49953eb60c9a44f61ba33d66ffb206d222cb8f0187593258704c105978f2c8e9dbc8dbb93e0a0881fd5bd6eddfbf2f527d8be2fb660d1e7d2025d784ff0e917c003df5694f7a3018f16e789f4dba71059c27bd8ba41f5431eb6768b3dd7a35679ef53a8e0354f2206aa4b2b7064d0880cd87f791662d90463e2c6d959ac97edcc6ae84fed1d72db672106a6fc2ee015484a6faeb0c4786c8dbe7d8d07c7dcb114b36af4a4c8b4b4bfb4258188d723f8d9ac5c18b4bb88227b00ab87c4638507be6ad3ea713c9bfc29886dde445fc6e23c3e5de724e97b0f78f29cd202ba38c976e22ea97f2f34c02254de653b83b6347f8a241e6784a09f682502b0f05e1219ac99374dad50f5dd0efd1b08aa6be810fc491928212a4a6af5df77af82f6381f1cd36bae3bbf552c748860b194e49fd3e72d2b59b2ab0cf10aada049cc043f78cc27b320b848d1ce685f9c38cfb9e808ed1a3ca566490d00853c131ee082e82cfb8418d8045b6b4fa4a3429d9c8214aed8f0ea8db41ba576f7dec56a6af4372712de166615a54fe3ea1c3c2f60b9ffe17ae5671d1e9aed833b1d9b20164118d2b1cb049c8f4d42c4cec1495f5aae8de243c550e12129c19556f5a07fd2bef0702a3556995380bde79465585357576a2de5a28b93b72d314536a952b7e36a0deeca0d2adea9c2f14b0856cf7ca3fd4b561d4568b6bbe966a8511736ca044527af9280f866c6e839b7247d01d8b2ffc9c18fd17b72ba2e01667b2536d688dc4ba34e0b7373d8b69793346b0d33d7d60c722cc9faf643f34b48a6dc2f43a2cbc08e2e5d13947550ed0bfb3a80c69169d59cfd51a85d2f4ea33609ad43d58fc619181cf72c25bbe316166bb25a6217568b1960650567035e2b71b3de6e156faea538b828253b256e5887e80fa563c3afebdcd85db767b4ebfa0274eb9c1a7bdc2f1f11f47102cc1f740bf72562980a2d506acb972bddccf3c803c8287a9f59de3675ebec28840f640565429f395df65a75a8a22b2a62fbc3bac7f98ee0a652d4cbdd6effc45b334e6d98b2b35c2b47e6f455e8603f1d08e8eb1e3acca6fc23fc0f5e71be0bafc4b84a0ecf8e7094ae03dcab97a164cfecefe3d4de7439d26b54761881666086754567cbebdd689d076c303806f465b9b5dbf7c287f79b21e491df8f6b5459088e1013884027558034d94ab8bbc964af1cafa084fa38e40ece2158626b90c07ab1fe4e838e3a6537db199175724c3041ff81ad2249f3ec0c8dd1f405255cd5a9b4c60267d4f134fcfcea66b7dbbbc3c7fcc642b203cb7f3a9920015ac0ce3ea4cc6111f840a7266e25acfbe62d565f4d4b4ea7e3d2302133a8dbc9f076f112d1274d804cd4058e7b06ce2a5ed8027939e7ca3a7c63be02a07cef8865f45688e14dfa0690cb4fbc02631df44fab01ce179d8859b4509a6b7161e55fbfeadc38b21e144dd0e7edab3c3ff5112fb7c13b647bbee841aff47f3adea60709f7b7beaa58438b5013d0c2e9835bb9104cf8cd753833d4a6105ea9f43ee28fe758f81daa33b1c4fc35aef95b5510eda4772addeaaf7d1a7a359a79edc4d18727dc5812fa799c65267d8d9d5115d509464e06ba076f898a63a2b82e456cc08</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好, 这里需要密码.</span>      </label>    </div>  </div></div><script data-pjax src="/blog/lib/hbe.js"></script><link href="/blog/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 日记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
            <tag> 周记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue源码（nextTick）</title>
      <link href="/blog/2021/03256587.html"/>
      <url>/blog/2021/03256587.html</url>
      
        <content type="html"><![CDATA[<h1 id="Vue源码（nextTick）"><a href="#Vue源码（nextTick）" class="headerlink" title="Vue源码（nextTick）"></a>Vue源码（nextTick）</h1><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>注意看注释</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">/* @flow */</span><span class="token comment">/* globals MutationObserver */</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> noop <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'shared/util'</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> handleError <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./error'</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> isIE<span class="token punctuation">,</span> isIOS<span class="token punctuation">,</span> isNative <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./env'</span><span class="token keyword">export</span> <span class="token keyword">let</span> isUsingMicroTask <span class="token operator">=</span> <span class="token boolean">false</span><span class="token keyword">const</span> callbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// by wq 首先创建一个数组，用来存放回调数组</span><span class="token keyword">let</span> pending <span class="token operator">=</span> <span class="token boolean">false</span><span class="token keyword">function</span> <span class="token function">flushCallbacks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// by wq 遍历执行callbacks数组方法</span>  pending <span class="token operator">=</span> <span class="token boolean">false</span>  <span class="token keyword">const</span> copies <span class="token operator">=</span> callbacks<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  callbacks<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> copies<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    copies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">let</span> timerFunc<span class="token comment">// by wq promise > MutationObserver > setImmediate > setTimeout 兼容做法, </span><span class="token comment">// 实现timerFunc, 原理事件循环</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Promise <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isNative</span><span class="token punctuation">(</span>Promise<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>isIOS<span class="token punctuation">)</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>noop<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span>  isUsingMicroTask <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isIE <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> MutationObserver <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>  <span class="token function">isNative</span><span class="token punctuation">(</span>MutationObserver<span class="token punctuation">)</span> <span class="token operator">||</span>  <span class="token comment">// PhantomJS and iOS 7.x</span>  MutationObserver<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object MutationObserverConstructor]'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// Use MutationObserver where native Promise is not available,</span>  <span class="token comment">// e.g. PhantomJS, iOS7, Android 4.4</span>  <span class="token comment">// (#6466 MutationObserver is unreliable in IE11)</span>  <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">1</span>  <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>  <span class="token keyword">const</span> textNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">)</span>  observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>textNode<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    characterData<span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    counter <span class="token operator">=</span> <span class="token punctuation">(</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span>    textNode<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span>  isUsingMicroTask <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> setImmediate <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isNative</span><span class="token punctuation">(</span>setImmediate<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// Fallback to setImmediate.</span>  <span class="token comment">// Technically it leverages the (macro) task queue,</span>  <span class="token comment">// but it is still a better choice than setTimeout.</span>  <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token function">setImmediate</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// Fallback to setTimeout.</span>  <span class="token function-variable function">timerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * by wq 将回调函数放在callbacks 中 * @param cb 函数 * @param ctx  */</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">nextTick</span> <span class="token punctuation">(</span><span class="token parameter">cb<span class="token operator">?</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> ctx<span class="token operator">?</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">let</span> _resolve  callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> <span class="token string">'nextTick'</span><span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_resolve<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">_resolve</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pending<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    pending <span class="token operator">=</span> <span class="token boolean">true</span>    <span class="token function">timerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">// $flow-disable-line</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cb <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> Promise <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>      _resolve <span class="token operator">=</span> resolve    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="什么时候用到-nextTick"><a href="#什么时候用到-nextTick" class="headerlink" title="什么时候用到 $nextTick"></a>什么时候用到 $nextTick</h3><p>当需要操作dom时，一般需要用到<code>$nextTick</code>。</p><p>为什么呢？</p><p>每次Vue数据状态发生变化，会异步更新dom节点（diff算法，异步更新原理），这都属于主线任务（可参考事件循环）。<br>此时操作dom，可能dom节点都还没有生成。放在<code>$nextTick</code>里面（即异步处理的方式），可保证在dom节点更新完毕之后执行。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>$nextTick</code> 就是<code>promise</code>那套异步函数的原理。</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React组件</title>
      <link href="/blog/2021/032462118.html"/>
      <url>/blog/2021/032462118.html</url>
      
        <content type="html"><![CDATA[<h1 id="React组件"><a href="#React组件" class="headerlink" title="React组件"></a>React组件</h1><ul><li><a href="https://github.com/wix/react-native-calendars">日历组件</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 组件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React</title>
      <link href="/blog/2021/03222526.html"/>
      <url>/blog/2021/03222526.html</url>
      
        <content type="html"><![CDATA[<h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><ul><li>Basic Hooks<ul><li>useState</li><li>useEffect</li><li>useContext</li></ul></li><li>Additional Hooks<ul><li>useReducer</li><li>useCallback</li><li>useMemo</li><li>useRef</li><li>useImperativeHandle</li><li>useLayoutEffect</li><li>useDebugValue</li></ul></li></ul><p><code>useMemo</code>, <code>useCallback</code> 都是根据第二个参数（依赖项数组）去重新渲染组件或执行回调。 这种优化有助于避免在每次渲染时都进行高开销的计算</p><p><code>useEffect</code>是在<code>dom</code>渲染完成后，才执行。每次重新渲染都会销毁之前的<code>effect</code>，重建新的<code>effect</code>，以获取到最新的值，并执行effect。 可通过第二个参数，添加依赖项，只有依赖项变化才执行<code>useEffect</code>，以优化性能。<code>useEffect</code>不会造成阻塞。</p><p>延迟渲染</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token function">setShowChild</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>showChild <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Child <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue源码(keep-alive)</title>
      <link href="/blog/2021/031910385.html"/>
      <url>/blog/2021/031910385.html</url>
      
        <content type="html"><![CDATA[<h1 id="Vue源码-keep-alive"><a href="#Vue源码-keep-alive" class="headerlink" title="Vue源码(keep-alive)"></a>Vue源码(keep-alive)</h1><h3 id="官方代码-version-2-6-12"><a href="#官方代码-version-2-6-12" class="headerlink" title="官方代码 (version: 2.6.12)"></a>官方代码 (version: 2.6.12)</h3><p>详见注释部分</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">/* @flow */</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> isRegExp<span class="token punctuation">,</span> remove <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'shared/util'</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getFirstComponentChild <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'core/vdom/helpers/index'</span>type VNodeCache <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">?</span>VNode <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">getComponentName</span> <span class="token punctuation">(</span><span class="token parameter">opts<span class="token operator">:</span> <span class="token operator">?</span>VNodeComponentOptions</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>string <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> opts <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>Ctor<span class="token punctuation">.</span>options<span class="token punctuation">.</span>name <span class="token operator">||</span> opts<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">matches</span> <span class="token punctuation">(</span><span class="token parameter">pattern<span class="token operator">:</span> string <span class="token operator">|</span> RegExp <span class="token operator">|</span> Array<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">,</span> name<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> pattern<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pattern <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> pattern<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRegExp</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> pattern<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">/* istanbul ignore next */</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">pruneCache</span> <span class="token punctuation">(</span><span class="token parameter">keepAliveInstance<span class="token operator">:</span> any<span class="token punctuation">,</span> filter<span class="token operator">:</span> Function</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> cache<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> _vnode <span class="token punctuation">&#125;</span> <span class="token operator">=</span> keepAliveInstance  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> cache<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> cachedNode<span class="token operator">:</span> <span class="token operator">?</span>VNode <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedNode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">const</span> name<span class="token operator">:</span> <span class="token operator">?</span>string <span class="token operator">=</span> <span class="token function">getComponentName</span><span class="token punctuation">(</span>cachedNode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">)</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">pruneCacheEntry</span><span class="token punctuation">(</span>cache<span class="token punctuation">,</span> key<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> _vnode<span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * 销毁缓存的实例 * @param cache * @param key * @param keys * @param current */</span><span class="token keyword">function</span> <span class="token function">pruneCacheEntry</span> <span class="token punctuation">(</span>  <span class="token parameter">cache<span class="token operator">:</span> VNodeCache<span class="token punctuation">,</span>  key<span class="token operator">:</span> string<span class="token punctuation">,</span>  keys<span class="token operator">:</span> Array<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">,</span>  current<span class="token operator">?</span><span class="token operator">:</span> VNode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">const</span> cached <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span>  <span class="token comment">// 判断是否已缓存并且不是当前实例</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>current <span class="token operator">||</span> cached<span class="token punctuation">.</span>tag <span class="token operator">!==</span> current<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    cached<span class="token punctuation">.</span>componentInstance<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">// 销毁缓存实例后，remove对于的key</span>  cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token function">remove</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">const</span> patternTypes<span class="token operator">:</span> Array<span class="token operator">&lt;</span>Function<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> RegExp<span class="token punctuation">,</span> Array<span class="token punctuation">]</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>  name<span class="token operator">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>  abstract<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// keep-alive的三个属性</span>  props<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    include<span class="token operator">:</span> patternTypes<span class="token punctuation">,</span>    exclude<span class="token operator">:</span> patternTypes<span class="token punctuation">,</span>    max<span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Number<span class="token punctuation">]</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 创建存放缓存实例的cache以及存放响应的[]key</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>cache <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token function">destroyed</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 遍历销毁所有实例</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">pruneCacheEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keys<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 判断cache中的实例，不在include数组中，则销毁</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'include'</span><span class="token punctuation">,</span> <span class="token parameter">val</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>      <span class="token function">pruneCache</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token parameter">name</span> <span class="token operator">=></span> <span class="token function">matches</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">// 判断cache中的实例，在exclude数组中，则销毁</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'exclude'</span><span class="token punctuation">,</span> <span class="token parameter">val</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>      <span class="token function">pruneCache</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token parameter">name</span> <span class="token operator">=></span> <span class="token operator">!</span><span class="token function">matches</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> slot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default    <span class="token comment">// 获取第一个子组件</span>    <span class="token keyword">const</span> vnode<span class="token operator">:</span> VNode <span class="token operator">=</span> <span class="token function">getFirstComponentChild</span><span class="token punctuation">(</span>slot<span class="token punctuation">)</span>    <span class="token keyword">const</span> componentOptions<span class="token operator">:</span> <span class="token operator">?</span>VNodeComponentOptions <span class="token operator">=</span> vnode <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>componentOptions    <span class="token keyword">if</span> <span class="token punctuation">(</span>componentOptions<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// check pattern</span>      <span class="token keyword">const</span> name<span class="token operator">:</span> <span class="token operator">?</span>string <span class="token operator">=</span> <span class="token function">getComponentName</span><span class="token punctuation">(</span>componentOptions<span class="token punctuation">)</span>      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> include<span class="token punctuation">,</span> exclude <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">this</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>        <span class="token comment">// not included</span>        <span class="token punctuation">(</span>include <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>name <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">matches</span><span class="token punctuation">(</span>include<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>        <span class="token comment">// excluded</span>        <span class="token punctuation">(</span>exclude <span class="token operator">&amp;&amp;</span> name <span class="token operator">&amp;&amp;</span> <span class="token function">matches</span><span class="token punctuation">(</span>exclude<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> vnode      <span class="token punctuation">&#125;</span>      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> cache<span class="token punctuation">,</span> keys <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">this</span>    <span class="token comment">// 获取key值</span>      <span class="token keyword">const</span> key<span class="token operator">:</span> <span class="token operator">?</span>string <span class="token operator">=</span> vnode<span class="token punctuation">.</span>key <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token comment">// same constructor may get registered as different local components</span>        <span class="token comment">// so cid alone is not enough (#3269)</span>        <span class="token operator">?</span> componentOptions<span class="token punctuation">.</span>Ctor<span class="token punctuation">.</span>cid <span class="token operator">+</span> <span class="token punctuation">(</span>componentOptions<span class="token punctuation">.</span>tag <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">::</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>componentOptions<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">)</span>        <span class="token operator">:</span> vnode<span class="token punctuation">.</span>key    <span class="token comment">// 如果已经有缓存</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 取出对于的缓存，并放在keys数组最后</span>        vnode<span class="token punctuation">.</span>componentInstance <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>componentInstance        <span class="token comment">// make current key freshest</span>        <span class="token function">remove</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> key<span class="token punctuation">)</span>        keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 如果没有缓存，则缓存，</span>        cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> vnode        keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>              <span class="token comment">// 判断是否超过最大缓存组件数max，若超过，则销毁keys数组中的第一个实例</span>        <span class="token comment">// prune oldest entry </span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>max <span class="token operator">&amp;&amp;</span> keys<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token function">pruneCacheEntry</span><span class="token punctuation">(</span>cache<span class="token punctuation">,</span> keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> keys<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_vnode<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>keepAlive <span class="token operator">=</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> vnode <span class="token operator">||</span> <span class="token punctuation">(</span>slot <span class="token operator">&amp;&amp;</span> slot<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol><li><code>keep-alive</code> 有三个属性 <code>include</code> <code>exclude</code> <code>max</code></li><li><code>keep-alive</code> 是一个抽象组件，Vue 的文档没有提这个概念，实际上它在组件实例建立父子关系的时候会被忽略</li><li><code>keep-alive</code> 只处理第一个子元素，所以一般和它搭配使用的有 component 动态组件或者是 <code>router-view</code>，这点要牢记</li><li><code>keep-alive</code> 采用LRU缓存策略，即最近的缓存放在[]keys最后，当超过max时，从keys[0]删除。</li></ol><p>另外，keep-alive不会执行<code>created</code>和<code>mounted</code>钩子，若想进行一些操作，可使用<code>actived</code>和<code>deactivated</code></p><h3 id="参考博客："><a href="#参考博客：" class="headerlink" title="参考博客："></a>参考博客：</h3><p><a href="https://ustbhuangyi.github.io/vue-analysis/v2/extend/keep-alive.html#keep-alive">Vue.js技术揭秘</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 框架 </tag>
            
            <tag> 深入 </tag>
            
            <tag> 源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue面试题</title>
      <link href="/blog/2021/031848462.html"/>
      <url>/blog/2021/031848462.html</url>
      
        <content type="html"><![CDATA[<h1 id="Vue面试题"><a href="#Vue面试题" class="headerlink" title="Vue面试题"></a>Vue面试题</h1><h3 id="1-keep-alive的作用及原理"><a href="#1-keep-alive的作用及原理" class="headerlink" title="1. keep-alive的作用及原理"></a>1. keep-alive的作用及原理</h3><h3 id="2-computed实现原理，及与watch的区别"><a href="#2-computed实现原理，及与watch的区别" class="headerlink" title="2. computed实现原理，及与watch的区别"></a>2. computed实现原理，及与watch的区别</h3><ul><li>computed 每次都会重新计算吗？</li><li>watch 有哪些属性对象？</li></ul><h3 id="3-vux"><a href="#3-vux" class="headerlink" title="3. vux"></a>3. vux</h3><h3 id="4-vue-router"><a href="#4-vue-router" class="headerlink" title="4. vue-router"></a>4. vue-router</h3><h3 id="5-双向绑定原理"><a href="#5-双向绑定原理" class="headerlink" title="5. 双向绑定原理"></a>5. 双向绑定原理</h3><h3 id="6-自定义组件，如何实现v-model"><a href="#6-自定义组件，如何实现v-model" class="headerlink" title="6. 自定义组件，如何实现v-model"></a>6. 自定义组件，如何实现<code>v-model</code></h3><p>   <code>v-model</code>实际上是<code>value</code>和<code>@input</code>二者共同实现的</p><h3 id="7-混入的优缺点minix"><a href="#7-混入的优缺点minix" class="headerlink" title="7. 混入的优缺点minix"></a>7. 混入的优缺点minix</h3><h3 id="8-nextTick实现原理"><a href="#8-nextTick实现原理" class="headerlink" title="8. $nextTick实现原理"></a>8. $nextTick实现原理</h3><h3 id="9-vue3"><a href="#9-vue3" class="headerlink" title="9. vue3"></a>9. vue3</h3><h3 id="10-requestAnimationFrame"><a href="#10-requestAnimationFrame" class="headerlink" title="10. requestAnimationFrame"></a>10. requestAnimationFrame</h3><p>   <code>requestAnimationFrame</code> 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率</p><p>   在隐藏或不可见的元素中，<code>requestAnimationFrame</code> 将不会进行重绘或回流，这当然就意味着更少的 CPU、GPU 和内存使用量</p><p>   <code>requestAnimationFrame</code> 是由浏览器专门为动画提供的 API，在运行时浏览器会自动优化方法的调用，并且如果页面不是激活状态下的话，动画会自动暂停，有效节省了 CPU 开销</p><h3 id="11-性能优化"><a href="#11-性能优化" class="headerlink" title="11. 性能优化"></a>11. 性能优化</h3><h3 id="12-何时创建虚拟dom，又何时进行依赖收集？"><a href="#12-何时创建虚拟dom，又何时进行依赖收集？" class="headerlink" title="12. 何时创建虚拟dom，又何时进行依赖收集？"></a>12. 何时创建虚拟dom，又何时进行依赖收集？</h3><ul><li>防抖和节流， </li><li>requestAnimationFrame,</li></ul><h3 id="13-虚拟dom的优缺点？"><a href="#13-虚拟dom的优缺点？" class="headerlink" title="13. 虚拟dom的优缺点？"></a>13. 虚拟dom的优缺点？</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// TODO: 自己实现虚拟dom，创建，渲染流程</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>虚拟dom采用AST抽象语法树实现的</li></ul>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 框架 </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript面试题</title>
      <link href="/blog/2021/03183927.html"/>
      <url>/blog/2021/03183927.html</url>
      
        <content type="html"><![CDATA[<h1 id="Javascript面试题"><a href="#Javascript面试题" class="headerlink" title="Javascript面试题"></a>Javascript面试题</h1><h3 id="1-闭包原理"><a href="#1-闭包原理" class="headerlink" title="1. 闭包原理"></a>1. 闭包原理</h3><h3 id="2-http缓存"><a href="#2-http缓存" class="headerlink" title="2. http缓存"></a>2. http缓存</h3><p><a href="https://wangqiang0323.github.io/blog/2021/031756648.html">强制缓存和协商缓存</a></p><h3 id="3-防抖和节流"><a href="#3-防抖和节流" class="headerlink" title="3. 防抖和节流"></a>3. 防抖和节流</h3><h3 id="4-安全策略（XSS-CROS等）"><a href="#4-安全策略（XSS-CROS等）" class="headerlink" title="4. 安全策略（XSS, CROS等）"></a>4. 安全策略（XSS, CROS等）</h3><h3 id="5-call、apply、bind区别"><a href="#5-call、apply、bind区别" class="headerlink" title="5. call、apply、bind区别"></a>5. call、apply、bind区别</h3><h3 id="6-bind函数实现"><a href="#6-bind函数实现" class="headerlink" title="6. bind函数实现"></a>6. bind函数实现</h3><h3 id="7-事件捕获、事件冒泡和事件委托"><a href="#7-事件捕获、事件冒泡和事件委托" class="headerlink" title="7. 事件捕获、事件冒泡和事件委托"></a>7. 事件捕获、事件冒泡和事件委托</h3><p><code>element.addEventListener（&quot;click/mouseover...&quot;,fn,boolean）</code>第三个参数为true（捕获） 为false（冒泡）</p><p><a href="https://zhuanlan.zhihu.com/p/39567900">事件捕获、事件冒泡和事件委托</a></p><h3 id="8-get和post的区别"><a href="#8-get和post的区别" class="headerlink" title="8. get和post的区别"></a>8. get和post的区别</h3><ul><li><p>参数</p><p>  Get方法参数拼接在url中，写在 ? 后面，用 &amp; 分割。（当然也可以自己约定参数的写法）<br>  Post方法参数放在body中</p></li><li><p>安全性</p><p>  按照网上大部分文章的解释，POST 比 GET 安全，因为数据在地址栏上不可见。</p><p>  然而，从传输的角度来说，他们都是不安全的，因为 HTTP 在网络上是明文传输的，只要在网络节点上捉包，就能完整地获取数据报文。</p><p>  要想安全传输，就只有加密，也就是 HTTPS。</p></li><li><p>长度限制 </p><p>  在网上看到很多关于两者区别的文章都有这一条，提到浏览器地址栏输入的参数是有限的。</p><p>  首先说明一点，HTTP 协议没有 Body 和 URL 的长度限制，对 URL 限制的大多是浏览器和服务器的原因。</p><p>  浏览器原因就不说了，服务器是因为处理长 URL 要消耗比较多的资源，为了性能和安全（防止恶意构造长 URL 来攻击）考虑，会给 URL 长度加限制。</p></li></ul><p><a href="https://blog.fundebug.com/2019/02/22/compare-http-method-get-and-post/">get和post的区别</a></p><h3 id="9-HTTP报文结构"><a href="#9-HTTP报文结构" class="headerlink" title="9. HTTP报文结构"></a>9. HTTP报文结构</h3><p>一个HTTP请求报文由四个部分组成：请求行、请求头部、空行、请求数据。</p><p><a href="https://www.jianshu.com/p/e29a327f9441">HTTP报文结构</a></p><h3 id="10-前端模块化"><a href="#10-前端模块化" class="headerlink" title="10. 前端模块化"></a>10. 前端模块化</h3><p><a href="https://zhuanlan.zhihu.com/p/112068916">前端模块化</a></p><h3 id="11-promise"><a href="#11-promise" class="headerlink" title="11. promise"></a>11. promise</h3><ul><li><p>异步原理（三种状态，pending、fulfilled、rejected,同一时间只能存在一种状态,且状态一旦改变就不能再变。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// 打印结果：2  考察点 promise同一时间只能存在一种状态,且状态一旦改变就不能再变。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>promise.all实现思路</p></li></ul><h3 id="12-深拷贝和浅拷贝"><a href="#12-深拷贝和浅拷贝" class="headerlink" title="12. 深拷贝和浅拷贝"></a>12. 深拷贝和浅拷贝</h3><ul><li><p>深拷贝</p><p>  方法一</p>  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>oldObj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>  <strong>缺点：</strong></p><ul><li>如果obj里面有时间对象，则JSON.stringify后再JSON.parse的结果，时间将只是字符串的形式。而不是时间对象；</li><li>如果obj里有RegExp、Error对象，则序列化的结果将只得到空对象；</li><li>如果obj里有function，Symbol 类型，undefined，则序列化的结果会把函数或 undefined丢失；</li><li>如果obj里有NaN、Infinity和-Infinity，则序列化的结果会变成null</li><li>JSON.stringify()只能序列化对象的可枚举的自有属性，例如 如果obj中的对象是有构造函数生成的， 则使用JSON.parse(JSON.stringify(obj))深拷贝后，会丢弃对象的constructor</li></ul><p>  方法二</p>  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">let</span> newObj <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> newObj<span class="token punctuation">&#125;</span><span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>oldObj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  方法三</p><p>调用postMessage结构化克隆算法就可以使用。我们可以创建一个 MessageChannel 并发送消息。在接收端，消息包含我们原始数据对象的结构化克隆。</p>  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">structuralClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>port1<span class="token punctuation">,</span> port2<span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    port2<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token parameter">ev</span> <span class="token operator">=></span> <span class="token function">resolve</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    port1<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token comment">/* ... */</span><span class="token punctuation">;</span><span class="token keyword">const</span> clone <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">structuralClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  这种方法的缺点是它是异步的。虽然这并无大碍，但是有时候你需要使用同步的方式来深度拷贝一个对象。</p></li><li><p>浅拷贝</p>  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> newObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>oldObj<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>  另外数组浅拷贝还可使用Array.concat()和slice(0)。或者使用ES6扩展运算符<code>&#123;...oldObj&#125;</code></p></li></ul><p><a href="https://github.com/mqyqingfeng/Blog">参考指南</a></p>]]></content>
      
      
      <categories>
          
          <category> Javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础 </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>强制缓存和协商缓存</title>
      <link href="/blog/2021/031756648.html"/>
      <url>/blog/2021/031756648.html</url>
      
        <content type="html"><![CDATA[<h1 id="强制缓存和协商缓存"><a href="#强制缓存和协商缓存" class="headerlink" title="强制缓存和协商缓存"></a>强制缓存和协商缓存</h1><p>首先，缓存规则是由服务器返回给客户端的，包含在响应header中。</p><h2 id="强制缓存"><a href="#强制缓存" class="headerlink" title="强制缓存"></a>强制缓存</h2><p>对于强制缓存，有两个字段标识失效规则（Expires/Cache-Control）。</p><h3 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h3><p>Cache-Control 是最重要的规则。常见的取值有private、public、no-cache、max-age，no-store，默认为private。</p><ul><li>private:             客户端可以缓存</li><li>public:              客户端和代理服务器都可缓存（前端的同学，可以认为public和private是一样的）</li><li>max-age=xxx:   缓存的内容将在 xxx 秒后失效</li><li>no-cache:          需要使用对比缓存来验证缓存数据（后面介绍）</li><li>no-store:           所有内容都不会缓存，强制缓存，对比缓存都不会触发（对于前端开发来说，缓存越多越好，so…基本上和它说886）</li></ul><p>强制缓存：即客户端现访问浏览器缓存，</p><h2 id="对比缓存-协商缓存"><a href="#对比缓存-协商缓存" class="headerlink" title="对比缓存 / 协商缓存"></a>对比缓存 / 协商缓存</h2><p>对比缓存，顾名思义，需要进行比较判断是否可以使用缓存。<br>浏览器第一次请求数据时，服务器会将缓存标识与数据一起返回给客户端，客户端将二者备份至缓存数据库中。<br>再次请求数据时，客户端将备份的缓存标识发送给服务器，服务器根据缓存标识进行判断，判断成功后，返回304状态码，通知客户端比较成功，可以使用缓存数据。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>对于强制缓存，服务器通知浏览器一个缓存时间，在缓存时间内，下次请求，直接用缓存，不在时间内，执行比较缓存策略。</li><li>对于比较缓存，将缓存信息中的Etag和Last-Modified通过请求发送给服务器，由服务器校验，返回304状态码时，浏览器直接使用缓存。</li></ul><h2 id="思考：当发版时，如何解决浏览器缓存，保证用户看到新的页面？"><a href="#思考：当发版时，如何解决浏览器缓存，保证用户看到新的页面？" class="headerlink" title="思考：当发版时，如何解决浏览器缓存，保证用户看到新的页面？"></a>思考：当发版时，如何解决浏览器缓存，保证用户看到新的页面？</h2><ul><li>hash</li><li>时间戳</li><li>版本号</li></ul><blockquote><p><a href="https://www.cnblogs.com/chenqf/p/6386163.html">彻底弄懂HTTP缓存机制及原理</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础 </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React与Vue比较</title>
      <link href="/blog/2021/031656855.html"/>
      <url>/blog/2021/031656855.html</url>
      
        <content type="html"><![CDATA[<h1 id="React与Vue比较"><a href="#React与Vue比较" class="headerlink" title="React与Vue比较"></a>React与Vue比较</h1><h3 id="相同点"><a href="#相同点" class="headerlink" title="相同点"></a>相同点</h3><ul><li>React和Vue都采用虚拟dom</li><li>都有组件化的思想，提高组件复用</li><li>都采用了模版语言</li><li>都优化了页面更新渲染机制（一次事件循环，更新一次。react通过setState实现，vue通过异步函数，如promise.then, setTimeout）</li></ul><h3 id="不同点"><a href="#不同点" class="headerlink" title="不同点"></a>不同点</h3><ul><li>React采用单向数据流，而Vue采用双向绑定（虽然也可实现单向数据流）</li><li>React推荐All In JS的思想，更像是一种思想而不是框架，代码层面更方便理解（因为数据流很清晰），更原生一些；<br>而Vue更像是一种框架，帮我们封装了数据的双向绑定，提供了生命周期钩子（React class写法也有）；</li><li>vue相对更易用，更容易上手。react得学习typescript，jsx等相关知识。</li><li>diff算法不同。如list列表，react会比较第一个字节点，如果不同，删除重建。vue会进行</li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 进阶 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Native搭建环境中遇到的问题</title>
      <link href="/blog/2021/031651881.html"/>
      <url>/blog/2021/031651881.html</url>
      
        <content type="html"><![CDATA[<h1 id="React-Native搭建环境中遇到的问题"><a href="#React-Native搭建环境中遇到的问题" class="headerlink" title="React Native搭建环境中遇到的问题"></a>React Native搭建环境中遇到的问题</h1><h3 id="环境搭建场景问题："><a href="#环境搭建场景问题：" class="headerlink" title="环境搭建场景问题："></a>环境搭建场景问题：</h3><ol><li>mac 下解决 EMFILE: too many open files, watch。。。</li></ol><ul><li>brew install watchman</li></ul><ol start="2"><li>mac 下，yarn run pod_install 安装问题。。</li></ol><ul><li>从其他同事电脑拷贝 ~/Library/Caches/CocoaPods 到本地（特别注意，需要使用本机的 version 文件替换其他同事下 Pods 下的 version 文件）</li><li>拷贝完成后，再运行一次yarn run pod_install</li></ul><ol start="3"><li>mac 下，12.3 版本的 xcode 下，安装 pod，出现 ：Build issue with Xcode 12.3 - file not found #include “ruby/config.h”</li></ol><ul><li><a href="https://github.com/CocoaPods/CocoaPods/issues/10286">https://github.com/CocoaPods/CocoaPods/issues/10286</a><br>cd $(xcode-select -p)/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/System/Library/<br>Frameworks/Ruby.framework/Versions/2.6/usr/include/ruby-2.6.0 &amp;&amp; ln -s universal-darwin20 universal-darwin19</li></ul><ol start="4"><li>mac 下，找不到 ios/bundle 目录</li></ol><ul><li>手动创建 ios/bundle 目录</li></ul><h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><ol><li>需安装<a href="https://github.com/infinitered/reactotron/releases">reactotron</a> ，根据自己的系统安装对应的应用即可</li><li>打开安装好的 reactotron 应用，重启模拟器就 ok</li><li>如果是安卓模拟器，需进入<code>Reactotron.ts</code>文件，将第 8 行 host 填自己本地 ip 即可(port 不用)</li><li>在想调试的地方 console.react(…yourContent)即可在应用上看到</li></ol>]]></content>
      
      
      <categories>
          
          <category> React Native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开发环境 </tag>
            
            <tag> 框架 </tag>
            
            <tag> APP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>防抖和节流</title>
      <link href="/blog/2021/031635375.html"/>
      <url>/blog/2021/031635375.html</url>
      
        <content type="html"><![CDATA[<h1 id="防抖和节流"><a href="#防抖和节流" class="headerlink" title="防抖和节流"></a>防抖和节流</h1><h3 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">/** * 防抖 * @param fn * @param wait * @returns &#123;function(): void&#125; */</span><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span>    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">/** *  * @param fn * @param wait */</span><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span>    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token keyword">return</span>        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>            timer <span class="token operator">=</span> <span class="token keyword">null</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>wait<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础 </tag>
            
            <tag> 优化 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
